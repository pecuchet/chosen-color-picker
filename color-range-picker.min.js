const DOC=document,DEFAULTS={parent:null,target:null,size:150,onPick:null,colors:["#fd5308","#fb9902","#fabc02","#fefe33","#d0ea2b","#66b032","#0391ce","#0247fe","#3d01a4","#8601af","#a7194b","#fe2712"]};class ColorRangePicker{constructor(t){const e=t=>`Provide a 'options.${t}' element to append the color picker to.`;if(t.parent=ColorRangePicker._cacheEl(t.parent),t.target=ColorRangePicker._cacheEl(t.target),!t.parent)throw new TypeError(e("parent"));if(!t.target)throw new TypeError(e("target"));this.opt=Object.assign({},DEFAULTS,t),this.canvas=null,this.color=null,this._bind()}static _cacheEl(t){return t?"string"==typeof t?DOC.querySelector(t):t.nodeType?t:null:null}_setup(){const t=this.opt,e=t.parent,o=DOC.createElement("canvas"),r=o.style;return o.height=o.width=t.size,r.display="none",r.position="absolute",r.top=r.left=`-${t.size/2-e.clientWidth/2}px`,ColorRangePicker._draw(o.getContext("2d"),t.size,t.colors),e.classList.add("has-picker"),e.style.position="relative",e.appendChild(o),this.canvas=o,this}static _draw(t,e,o=[]){const r=e/2,i=360/o.length;let n=270,s=270+i;o.forEach((e,o)=>{setTimeout(()=>{t.beginPath(),t.arc(r,r,50,n*Math.PI/180,s*Math.PI/180,!1),t.lineWidth=30,t.strokeStyle=e,t.stroke(),n+=i,s+=i},30*o)})}_pick(t,e){const o=t.getBoundingClientRect(),r=t.getContext("2d").getImageData(e.clientX-o.left,e.clientY-o.top,1,1).data;this.color=[r[0],r[1],r[2]],this.opt.target.style.backgroundColor=`rgb(${this.color.join(",")})`,this.toggle()}get rgb(){return this.color?`rgb(${this.color.join(",")})`:""}get hex(){return this.color?ColorRangePicker.RGBToHex(this.color):""}static RGBToHex(t){let e=Array.isArray(t)?t:t.match(/\d+/g),o=t=>{let e=parseInt(t,10).toString(16);return 1===e.length?"0"+e:e};return"#"+o(e[0])+o(e[1])+o(e[2])}range(t=.1){let e=[],o=this.color;for(let r=-.5;r<.5;r+=t){let t=r<0?0:255,i=r<0?-1*r:r,n=parseInt(o[0]),s=parseInt(o[1]),a=parseInt(o[2]);e.push("rgb("+(Math.round((t-n)*i)+n)+","+(Math.round((t-s)*i)+s)+","+(Math.round((t-a)*i)+a)+")")}return e}toggle(){const t=this.canvas.style;return t.display="none"!==t.display?"none":"block"}destroy(){let t=this.opt.parent;t.classList.remove("has-picker"),t.removeEventListener("click",this._click,!1),this.opt=this.canvas=this.color=null}_bind(){this.opt.parent.addEventListener("click",this._click=this._click.bind(this),!1)}_click(t){const e=t.target;return this.opt.parent.classList.contains("has-picker")?"canvas"===e.nodeName.toLowerCase()?(this._pick(e,t),void("function"==typeof this.opt.onPick&&this.opt.onPick.call(this,this))):this.toggle():this._setup().toggle()}}export default ColorRangePicker;
