const DOC=document,DEFAULTS={parent:null,target:null,size:150,colors:["#fd5308","#fb9902","#fabc02","#fefe33","#d0ea2b","#66b032","#0391ce","#0247fe","#3d01a4","#8601af","#a7194b","#fe2712"]};class ColorRangePicker{constructor(t){const e=t=>`Provide a 'options.${t}' element to append the color picker to.`;if(t.parent=t.parent?DOC.querySelector(t.parent):null,t.target=t.target?DOC.querySelector(t.target):null,!t.parent)throw new TypeError(e("parent"));if(!t.target)throw new TypeError(e("target"));this.opt=Object.assign({},DEFAULTS,t),this.canvas=null,this.color=null,this._bind()}_setup(){const t=this.opt,e=t.parent,r=DOC.createElement("canvas"),o=r.style;return r.height=r.width=t.size,o.display="none",o.position="absolute",o.top=o.left=`-${t.size/2-e.clientWidth/2}px`,ColorRangePicker._draw(r.getContext("2d"),t.size,t.colors),e.classList.add("has-picker"),e.style.position="relative",e.appendChild(r),this.canvas=r,this}static _draw(t,e,r=[]){const o=e/2,s=360/r.length;let n=270,i=270+s;r.forEach((e,r)=>{setTimeout(()=>{t.beginPath(),t.arc(o,o,50,n*Math.PI/180,i*Math.PI/180,!1),t.lineWidth=30,t.strokeStyle=e,t.stroke(),n+=s,i+=s},30*r)})}_pick(t,e){const r=t.getBoundingClientRect(),o=t.getContext("2d").getImageData(e.clientX-r.left,e.clientY-r.top,1,1).data;this.color=[o[0],o[1],o[2]],this.opt.target.style.backgroundColor=`rgb(${this.color.join(",")})`,this.toggle()}get rgb(){return this.color?`rgb(${this.color.join(",")})`:""}get hex(){return this.color?ColorRangePicker.RGBToHex(this.color):""}static RGBToHex(t){let e=Array.isArray(t)?t:t.match(/\d+/g),r=t=>{let e=parseInt(t,10).toString(16);return 1===e.length?"0"+e:e};return"#"+r(e[0])+r(e[1])+r(e[2])}range(t=.1){let e=[],r=this.color;for(let o=-.5;o<.5;o+=t){let t=o<0?0:255,s=o<0?-1*o:o,n=parseInt(r[0]),i=parseInt(r[1]),a=parseInt(r[2]);e.push("rgb("+(Math.round((t-n)*s)+n)+","+(Math.round((t-i)*s)+i)+","+(Math.round((t-a)*s)+a)+")")}return e}toggle(){const t=this.canvas.style;return t.display="none"!==t.display?"none":"block"}destroy(){let t=this.opt.parent;t.classList.remove("has-picker"),t.removeEventListener("click",this._click,!1),this.opt=this.canvas=this.color=null}_bind(){this.opt.parent.addEventListener("click",this._click=this._click.bind(this),!1)}_click(t){const e=t.target;return this.opt.parent.classList.contains("has-picker")?"canvas"===e.nodeName.toLowerCase()?this._pick(e,t):this.toggle():this._setup().toggle()}}export default ColorRangePicker;
